<h1>投稿一覧</h1>
<ul>
  <% @posts.each do |post| %>
    <li>
      <% if post.image? %>
        <%= image_tag post.image.thumb.url %>
      <% else %>
        <%= image_tag 'noimage.gif' %>
      <% end %>
      <%= link_to post.shop_name, post %>: <%= congestion_values[post.congestion] %>
      <%= link_to '投稿を編集する', edit_post_path(post) %>
      <%= link_to '投稿を削除する', post, method: :delete, data: { confirm: '本当に削除してよろしいですか？' } %>
    </li>
  <% end %>
</ul>

<div class="row">
  <aside class="col-xs-4">
    <div class="panel-heading">
      <h3 class="panel-title"><%= @user.name %></h3>
    </div>
    <div class="panel-body">
      <img class="media-object img-rounded img-responsive" src="<%= gravatar_url(@user, { size: 500}) %>" alt="">
    </div>
    <%= link_to '混み具合を報告', new_post_path %>
    
  </aside>
  <!--<div class="col-xs-8">-->
  <!--  <ul class="nav nav-tabs nav-justified">-->
  <!--    <li><a href="#">自分の投稿</a></li>-->
  <!--    <#%= link_to '投稿を編集する', edit_post_path(@post) %>-->
  <!--  <%#= link_to '投稿を削除する', @post, method: :delete, data: { confirm: '本当に削除してよろしいですか？' } %>-->
  <!--  </ul>-->
  <!--</div>-->
</div>

<% content_for :head do %>
  <script src="//maps.google.com/maps/api/js?v=3&key=AIzaSyCktzdkvWZpHN-xQkqHGIdzw71gx1sfJDA"></script>
  <script src="//cdn.rawgit.com/mahnunchik/markerclustererplus/master/dist/markerclusterer.min.js"></script>
  <script src='//cdn.rawgit.com/printercu/google-maps-utility-library-v3-read-only/master/infobox/src/infobox_packed.js' type='text/javascript'></script> <!-- only if you need custom infoboxes -->
<% end %>

<div style='width: 800px;'>
  <div id="map" style='width: 800px; height: 400px;'></div>
</div>

<script type="text/javascript">
    handler = Gmaps.build('Google');
    handler.buildMap({ provider: {}, internal: {id: 'map'}}, function(){
      markers = handler.addMarkers(<%=raw @hash.to_json %>);
      handler.bounds.extendWith(markers);
      handler.fitMapToBounds();
      handler.getMap().setZoom(15);
    });
</script>